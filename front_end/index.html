<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/@coreui/coreui@4.2.0/dist/css/coreui.min.css" rel="stylesheet" integrity="sha384-UkVD+zxJKGsZP3s/JuRzapi4dQrDDuEf/kHphzg8P3v8wuQ6m9RLjTkPGeFcglQU" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <div class="container-fluid p-0 m-0">
        <div class="wrapper d-flex flex-column min-vh-100 bg-light">
        <header class="header header-sticky mb-4">
            <div class="container-fluid">
            <button class="header-toggler px-md-0 me-md-3" type="button" onclick="coreui.Sidebar.getInstance(document.querySelector('#sidebar')).toggle()">
                <svg class="icon icon-lg">
                <use xlink:href="node_modules/@coreui/icons/sprites/free.svg#cil-menu"></use>
                </svg>
            </button><a class="header-brand d-md-none" href="#">
                <svg width="118" height="46" alt="CoreUI Logo">
                <use xlink:href="assets/brand/coreui.svg#full"></use>
                </svg></a>
            <ul class="header-nav d-none d-md-flex">
                <li class="nav-item"><a class="nav-link" href="#">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="#">Users</a></li>
                <li class="nav-item"><a class="nav-link" href="#">Settings</a></li>
                <li class="nav-item"><a class="nav-link" href="/logout">Logout</a></li>
            </ul>
            <ul class="header-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="#">
                    <svg class="icon icon-lg">
                    <use xlink:href="node_modules/@coreui/icons/sprites/free.svg#cil-bell"></use>
                    </svg></a></li>
                <li class="nav-item"><a class="nav-link" href="#">
                    <svg class="icon icon-lg">
                    <use xlink:href="node_modules/@coreui/icons/sprites/free.svg#cil-list-rich"></use>
                    </svg></a></li>
                <li class="nav-item"><a class="nav-link" href="#">
                    <svg class="icon icon-lg">
                    <use xlink:href="node_modules/@coreui/icons/sprites/free.svg#cil-envelope-open"></use>
                    </svg></a></li>
            </ul>
            <ul class="header-nav ms-3">
                <li class="nav-item dropdown"><a class="nav-link py-0" data-coreui-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                    <div class="avatar avatar-md"><img class="avatar-img" src="assets/img/avatars/8.jpg" alt=""></div></a>
                </li>
            </ul>
            </div>
            <div class="header-divider"></div>
            <div class="container-fluid">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb my-0 ms-2">
                <li class="breadcrumb-item">
                    <!-- if breadcrumb is single--><span>Home</span>
                </li>
                <li class="breadcrumb-item active"><span>Dashboard</span></li>
                </ol>
            </nav>
            </div>
        </header>
        <div class="body flex-grow-1 px-3">
            <div class="container-lg">
            <div class="card mb-4">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4 class="card-title mb-0">Transaksi</h4>
                        </div>
                    </div>
                    <div class="mt-3 mb-3">
                        <form action="">
                            <div class="form-group">
                                <label for="">Nama Produk</label>
                                <input class="form-control" name="nama_produk" id="nama_produk" type="text" placeholder="Default input" aria-label="default input example">
                            </div>
                            <div class="form-group">
                                <label for="">Status Pembayaran</label>
                                <select name="status_pembayaran" id="status_pembayaran" class="form-control" id="">
                                    <option value="Success">Success</option>
                                    <option value="Void">Void</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="">Tipe Penjualan</label>
                                <select name="tipe_penjualan" id="tipe_penjualan" class="form-control" id="">
                                    <option value="Dine In">Dine In</option>
                                    <option value="Take Away">Take Away</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="">Harga</label>
                                <input class="form-control" name="harga" id="harga" type="text" placeholder="Default input" aria-label="0">
                            </div>
                            <button type="submit" class="btn btn-success text-white mt-2" id="submit">Kirim</button>
                        </form>
                    </div>
                    <table  class="table table-hover">
                        <thead>
                            <th>Nama Produk</th>
                            <th>Status Pembayaran</th>
                            <th>Tipe Penjualan</th>
                            <th>Harga</th>
                        </thead>
                        <tbody id='myTable'>
                
                        </tbody>
                    </table>
                </div>

            </div>
            </div>
        </div>
        <footer class="footer">
            <div><a href="https://coreui.io">CoreUI </a><a href="https://coreui.io">Bootstrap Admin Template</a> &copy; 2022 creativeLabs.</div>
            <div class="ms-auto">Powered by&nbsp;<a href="https://coreui.io/docs/">CoreUI UI Components</a></div>
        </footer>
        </div>
    </div>
    
    
    
</body>
<script src="https://cdn.jsdelivr.net/npm/@coreui/coreui@4.2.0/dist/js/coreui.bundle.min.js" integrity="sha384-n0qOYeB4ohUPebL1M9qb/hfYkTp4lvnZM6U6phkRofqsMzK29IdkBJPegsyfj/r4" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(document).ready(function(e) {   
        $.ajax({
            url: 'http://localhost:8080/api/transaksi/',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            type: "GET", /* or type:"GET" or type:"PUT" */
            dataType: "json",
            data: {
            },
            success: function (result) {
                buildTable(result);
            },
            error: function () {
                console.log("error");
            }
        });
    });

    $("#submit").click(function(e) {   
        var data = {
            'nama_produk' :$("#nama_produk").val(),
            'status_pembayaran' : $("#status_pembayaran").val(),
            'tipe_penjualan' : $("#tipe_penjualan").val(),
            'harga'  : Number($("#harga").val())
        }
        
        $.ajax({
            url: 'http://localhost:8080/api/transaksi/',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            type: "POST", /* or type:"GET" or type:"PUT" */
            data: JSON.stringify(data)
            
        });
    });


    

    function buildTable(data) {
        var table = document.getElementById('myTable')

        for (var i = 0; i < data.length; i++) {
        var row = `<tr>
                            <td>${data[i].nama_produk}</td>
                            <td>${data[i].status_pembayaran}</td>
                            <td>${data[i].tipe_penjualan}</td>
                            <td>${data[i].harga}</td>
                            <td><input type="hidden" id="id" value="${data[i]._id}"><button class="btn btn-danger text-white mt-2" id="delete">Delete</button></td>
                            
                      </tr>`
        table.innerHTML += row
    }
    }

    $("#delete").click(function(e) {  
        alert("OKE") 
        var id = $("id").val()
        
        
        $.ajax({
            url: 'http://localhost:8080/api/transaksi/'+id,
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            type: "DELETE", /* or type:"GET" or type:"PUT" */
            
        });
    });
</script>
</html>
